<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QUIZ DE PERSONALIDADE | CLUBE DA FENDA</title>
  <link rel="stylesheet" href="quiz_personalidade.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>

<body>
  <header class="menu-lateral">
    <div class="logo">
      <div class="linha">
        <span class="letra" style="background-position: 0% 0%;">C</span>
        <span class="letra" style="background-position: 8% 0%;">l</span>
        <span class="letra" style="background-position: 16% 0%;">u</span>
        <span class="letra" style="background-position: 24% 0%;">b</span>
        <span class="letra" style="background-position: 32% 0%;">e</span>
        <span class="espaco"></span>
        <span class="letra" style="background-position: 48% 0%;">d</span>
        <span class="letra" style="background-position: 56% 0%;">a</span>
      </div>
      <div class="linha">
        <span class="letra" style="background-position: 72% 0%;">F</span>
        <span class="letra" style="background-position: 80% 0%;">e</span>
        <span class="letra" style="background-position: 88% 0%;">n</span>
        <span class="letra" style="background-position: 96% 0%;">d</span>
        <span class="letra" style="background-position: 104% 0%;">a</span>
      </div>
    </div>
    <nav role="navigation">
      <div class="hello">
        <h3>Ol√°, <span id="b_usuario">usu√°rio</span>!</h3>
      </div>
      <ul>
        <li id="dashboard">
          <span class="material-symbols-outlined">dashboard</span>
          <a href="/dashboard/overview.html">OVERVIEW</a>
        </li>
        <li class="ativo" aria-current="page" id="games">
          <span class="material-symbols-outlined">sports_esports</span>
          <a href="/dashboard/games.html">GAMES</a>
        </li>
        <li id="perfil">
          <span class="material-symbols-outlined">person</span>
          <a href="perfil.html">PERFIL</a>
        </li>
        <li id="sair">
          <span class="material-symbols-outlined">logout</span>
          <a onclick="limparSessao()">SAIR</a>
        </li>
      </ul>
    </nav>
  </header>


  <div id="tela-inicial" style="display: flex;">
    <div class="container">
      <h1 class="titulo">
        <span class="letra" style="background-position: 0% 0%;">Q</span>
        <span class="letra" style="background-position: 8% 0%;">u</span>
        <span class="letra" style="background-position: 16% 0%;">i</span>
        <span class="letra" style="background-position: 24% 0%;">z</span>
        <span class="letra espaco"></span>
        <span class="letra" style="background-position: 32% 0%;">d</span>
        <span class="letra" style="background-position: 40% 0%;">e</span>
        <span class="letra espaco"></span>
        <span class="letra" style="background-position: 48% 0%;">P</span>
        <span class="letra" style="background-position: 56% 0%;">e</span>
        <span class="letra" style="background-position: 64% 0%;">r</span>
        <span class="letra" style="background-position: 72% 0%;">s</span>
        <span class="letra" style="background-position: 80% 0%;">o</span>
        <span class="letra" style="background-position: 88% 0%;">n</span>
        <span class="letra" style="background-position: 96% 0%;">a</span>
        <span class="letra" style="background-position: 104% 0%;">l</span>
        <span class="letra" style="background-position: 112% 0%;">i</span>
        <span class="letra" style="background-position: 120% 0%;">d</span>
        <span class="letra" style="background-position: 128% 0%;">a</span>
        <span class="letra" style="background-position: 136% 0%;">d</span>
        <span class="letra" style="background-position: 144% 0%;">e</span>
      </h1>
      <h2>Qual personagem do Bob Esponja voc√™ seria?</h2>
      <h3>Responda as perguntas e descubra!</h3>
      <button onclick="iniciarQuiz()" id="botao-iniciar">Iniciar</button>
    </div>
  </div>

  <div id="tela-quiz" style="display: none;">
    <div class="quiz-container">
      <div id="quiz"></div>
      <span class="numero-pergunta" id="numero-pergunta" style="background-position: 0% 0%;">1</span>
      <div id="pergunta"></div>
      <div id="opcoes"></div>
    </div>
  </div>

  <div id="tela-feedback">
    <div id="resultado" style="display: none;">
      <p id="resultado-texto"></p>
      <img id="resultado-imagem" src="" alt="Imagem do personagem">
      <br>
      <button id="reiniciar-quiz" onclick="reiniciarQuiz()">Refazer Quiz</button>
      <button id="voltar-inicio" onclick="voltarInicio()">Tela inicial</button>
    </div>
  </div>
  <script src="/Users/Thalita/Desktop/Clube da fenda/web-data-viz - clube da fenda/public/js/frases_aleatorias.js"></script>
  <script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    const perguntas = [
      {
        pergunta: "O que voc√™ mais gosta de fazer no tempo livre?",
        respostas: {
          Bob: "Trabalhar em algo que gosto.",
          Patrick: "Relaxar sem fazer nada.",
          Siriguejo: "Pensar em formas de ganhar dinheiro.",
          Plankton: "Criar planos inteligentes.",
          Sandy: "Treinar ou aprender algo novo.",
          Lula: "Tocar m√∫sica ou ficar sozinho."
        }
      },
      {
        pergunta: "Qual dessas qualidades mais combina com voc√™?",
        respostas: {
          Bob: "Otimismo.",
          Patrick: "Lealdade.",
          Siriguejo: "Ambi√ß√£o.",
          Plankton: "Intelig√™ncia.",
          Sandy: "Determina√ß√£o.",
          Lula: "Criatividade."
        }
      },
      {
        pergunta: "Qual √© o seu maior defeito?",
        respostas: {
          Bob: "Ingenuidade.",
          Patrick: "Pregui√ßa.",
          Siriguejo: "Gan√¢ncia.",
          Plankton: "Teimosia.",
          Sandy: "Competitividade.",
          Lula: "Impaci√™ncia."
        }
      },
      {
        pergunta: "Como voc√™ reage diante de um problema?",
        respostas: {
          Bob: "Procuro resolver com bom humor.",
          Patrick: "Fico confuso, mas tento ajudar.",
          Siriguejo: "Vejo se afeta meu bolso primeiro.",
          Plankton: "Elaboro um plano estrat√©gico.",
          Sandy: "Analiso e resolvo com efici√™ncia.",
          Lula: "Reclamo, mas acabo resolvendo."
        }
      },
      {
        pergunta: "Qual desses lugares voc√™ prefere?",
        respostas: {
          Bob: "Trabalho ou lugares animados.",
          Patrick: "Minha cama.",
          Siriguejo: "Qualquer lugar que me renda lucro.",
          Plankton: "Meu laborat√≥rio.",
          Sandy: "A natureza.",
          Lula: "Museus ou casa tranquila."
        }
      },
      {
        pergunta: "Como seus amigos te descrevem?",
        respostas: {
          Bob: "Animado e prestativo.",
          Patrick: "Engra√ßado e fiel.",
          Siriguejo: "Ambicioso e mand√£o.",
          Plankton: "Inteligente, mas maluco.",
          Sandy: "Forte e inteligente.",
          Lula: "Cr√≠tico e reservado."
        }
      },
      {
        pergunta: "Qual dessas comidas voc√™ escolheria?",
        respostas: {
          Bob: "Hamb√∫rguer de Siri, claro!",
          Patrick: "Tudo que for comida!",
          Siriguejo: "Algo barato.",
          Plankton: "Comida feita por mim mesmo.",
          Sandy: "Algo nutritivo e pr√°tico.",
          Lula: "Algo sofisticado e leve."
        }
      },
      {
        pergunta: "O que te deixa irritado?",
        respostas: {
          Bob: "Des√¢nimo das pessoas.",
          Patrick: "Ter que pensar muito.",
          Siriguejo: "Perder dinheiro.",
          Plankton: "Fracassar nos meus planos.",
          Sandy: "Desrespeito ou subestimar minha capacidade.",
          Lula: "Gente barulhenta e sem no√ß√£o."
        }
      },
      {
        pergunta: "Se voc√™ pudesse escolher um superpoder, qual seria?",
        respostas: {
          Bob: "Fazer todos sorrirem.",
          Patrick: "Dormir o tempo que quiser.",
          Siriguejo: "Transformar tudo em ouro.",
          Plankton: "Dominar mentes.",
          Sandy: "For√ßa extrema.",
          Lula: "Ficar invis√≠vel."
        }
      },
      {
        pergunta: "O que voc√™ valoriza em um amigo?",
        respostas: {
          Bob: "Alegria e parceria.",
          Patrick: "Companhia, mesmo sem falar nada.",
          Siriguejo: "Lealdade nos neg√≥cios.",
          Plankton: "Ajuda nos meus planos.",
          Sandy: "Apoio e crescimento m√∫tuo.",
          Lula: "Sil√™ncio e respeito ao espa√ßo."
        }
      }

    ];

    let perguntaAtual = 0;
    const pontuacao = {
      Bob: 0,
      Patrick: 0,
      Siriguejo: 0,
      Plankton: 0,
      Sandy: 0,
      Lula: 0
    };

    function iniciarQuiz() {
      document.getElementById("tela-inicial").style.display = "none";
      document.getElementById("tela-quiz").style.display = "flex";
      mostrarPergunta();
    }

    function mostrarPergunta() {
      const quizDiv = document.getElementById("pergunta");
      const opcoesDiv = document.getElementById("opcoes");
      const numeroPergunta = perguntaAtual + 1;
      document.getElementById("numero-pergunta").textContent = numeroPergunta;

      quizDiv.innerHTML = "";
      opcoesDiv.innerHTML = "";

      const pergunta = perguntas[perguntaAtual];
      const tituloPergunta = document.createElement("h2");
      tituloPergunta.textContent = pergunta.pergunta;
      quizDiv.appendChild(tituloPergunta);

      for (const personagem in pergunta.respostas) {
        const botao = document.createElement("button");
        botao.textContent = pergunta.respostas[personagem];
        botao.className = "opcoes";
        botao.onclick = () => selecionarResposta(personagem);
        opcoesDiv.appendChild(botao);
      }
    }

    function selecionarResposta(personagem) {
      pontuacao[personagem]++;
      perguntaAtual++;
      if (perguntaAtual < perguntas.length) {
        mostrarPergunta();
      } else {
        mostrarResultado();
      }
    }

    function mostrarResultado() {
      // Esconde a tela do quiz
      document.getElementById("tela-quiz").style.display = "none";

      // Mostra a tela de feedback
      const telaFeedback = document.getElementById("tela-feedback");
      telaFeedback.style.display = "flex";

      // Determina o personagem com a maior pontua√ß√£o
      const personagem = Object.keys(pontuacao).reduce((a, b) =>
        pontuacao[a] > pontuacao[b] ? a : b
      );

      // Mensagens de feedback
      const mensagens = {
        Bob: "Voc√™ √© otimista e trabalhador, assim como o Bob Esponja!üßΩ",
        Patrick: "Voc√™ √© leal e descontra√≠do, como o Patrick!‚≠êÔ∏è",
        Siriguejo: "Voc√™ √© ambicioso e focado, como o Sr. Siriguejo!ü¶Ä",
        Plankton: "Voc√™ √© inteligente e determinado, como o Plankton!ü¶†",
        Sandy: "Voc√™ √© determinado e curioso, como a Sandy!üêøÔ∏è",
        Lula: "Voc√™ √© criativo e reservado, como o Lula Molusco!ü¶ë"
      };



      // Caminhos das imagens
      const imagens = {
        Bob: "./assets/Personagens/bob_esponja.png",
        Patrick: "./assets/Personagens/patrick.png",
        Siriguejo: "./assets/Personagens/sr.sirigueijo.png",
        Plankton: "./assets/Personagens/plankton.png",
        Sandy: "./assets/Personagens/sandy.png",
        Lula: "./assets/Personagens/lula_molusco.png"
      };

      // Atualiza o texto e a imagem do feedback
      document.getElementById("resultado-texto").textContent = mensagens[personagem];
      const imagem = document.getElementById("resultado-imagem");
      imagem.src = imagens[personagem];
      imagem.alt = `Imagem de ${personagem}`;

      // <-- LINHA IMPORTANTE PARA MOSTRAR O FEEDBACK -->
      document.getElementById("resultado").style.display = "block";

      cadastrar();
    }

    function cadastrar() {
      console.log("ID do usu√°rio no sessionStorage:", sessionStorage.ID_USUARIO);

      const personagem = Object.keys(pontuacao).reduce((a, b) =>
        pontuacao[a] > pontuacao[b] ? a : b
      );

      const dados = {
        idUserServer: sessionStorage.ID_USUARIO, // Certifique-se de que "ID_USUARIO" est√° definido
        personagemQuizServer: personagem,
      };

      console.log("Enviando dados para o servidor:", dados);

      fetch("/quizPersonalidade/cadastrar", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(dados),
      })
        .then((resposta) => {
          if (resposta.ok) {
            console.log("Pontua√ß√£o enviada com sucesso!");
            return resposta.json();
          } else {
            throw new Error("Erro ao enviar a pontua√ß√£o.");
          }
        })
        .then((dados) => {
          console.log("Resposta do servidor:", dados);
        })
        .catch((erro) => {
          console.error("Erro no envio:", erro);
        });
    }

    function reiniciarQuiz() {
      perguntaAtual = 0;
      for (let personagem in pontuacao) {
        pontuacao[personagem] = 0;
      }
      document.getElementById("tela-feedback").style.display = "none";
      document.getElementById("tela-quiz").style.display = "flex";
      mostrarPergunta();
    }

    function voltarInicio() {
      perguntaAtual = 0;
      for (let personagem in pontuacao) {
        pontuacao[personagem] = 0;
      }
      document.getElementById("tela-feedback").style.display = "none";
      document.getElementById("tela-inicial").style.display = "flex";
    }

    function limparSessao() {
    sessionStorage.clear();
    window.location = "/login.html";
}
  </script>
</body>

</html>